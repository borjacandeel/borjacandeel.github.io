<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Pomodoro</title>
<style>
  :root{
    --bg:#f7f7f5; --panel:#ffffff; --text:#1f1f1f; --muted:#6b6b6b;
    --ring:#d9d9d9; --accent:#1f1f1f; --button:#efefef; --button-hover:#e5e5e5;
    --button-text:#1f1f1f; --shadow:0 10px 20px rgba(0,0,0,.06); --radius:14px;
  }
  [data-theme="dark"]{
    --bg:#0f1113; --panel:#171a1d; --text:#f1f1f1; --muted:#a4aab2;
    --ring:#2a2f35; --accent:#f1f1f1; --button:#20252b; --button-hover:#242a31;
    --button-text:#f1f1f1; --shadow:0 10px 24px rgba(0,0,0,.35);
  }
  *{box-sizing:border-box;}
  html,body{height:100%; margin:0;}
  body{
    background:var(--bg); color:var(--text);
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    display:grid; grid-template-rows:auto 1fr auto;
  }
  header,main{width:min(960px,92vw);margin:0 auto}
  header{display:flex;align-items:center;justify-content:space-between;padding:22px 0}
  .brand{font-weight:700}
  .theme-toggle{border:none;background:var(--button);color:var(--button-text);padding:10px 14px;border-radius:999px;cursor:pointer;display:flex;gap:8px;align-items:center;box-shadow:var(--shadow)}
  .theme-toggle:hover{background:var(--button-hover)}

  .row{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin:10px 0 24px}
  .chip{border:none;background:var(--button);color:var(--button-text);padding:10px 14px;border-radius:999px;cursor:pointer;box-shadow:var(--shadow)}
  .chip.active{outline:2px solid var(--accent)}
  .wrap{display:grid;place-items:center;text-align:center;gap:20px;padding:16px 0 8px}
  .timer{position:relative;width:min(420px,82vw);aspect-ratio:1/1;display:grid;place-items:center}
  .timer svg{position:absolute;inset:0;transform:rotate(-90deg)}
  .time{font-variant-numeric:tabular-nums;font-size:clamp(44px,6vw,72px);font-weight:700;letter-spacing:1px}
  .controls{display:flex;gap:12px;justify-content:center}
  .btn{
    border:none;background:var(--button);width:60px;height:60px;
    border-radius:18px;cursor:pointer;display:grid;place-items:center;
    box-shadow:var(--shadow);transition:background .2s;
  }
  .btn:hover{background:var(--button-hover)}
  .btn svg{width:28px;height:28px;stroke:var(--text);fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round}
  .hint{color:var(--muted);text-align:center;margin:10px 0 10px}
  .phase{color:var(--muted);font-weight:600;letter-spacing:.3px}

  /* sonidos (centrados) */
  .sounds{
    width:100%;
    display:flex;
    flex-direction:column;
    align-items:center;
    margin:26px 0 40px;
    text-align:center;
  }
  .sounds h3{margin-bottom:16px;font-weight:700;color:var(--muted)}
  .sound-grid{
    display:flex;
    justify-content:center;
    align-items:center;
    gap:80px;
  }
  .sound-tile{display:flex;flex-direction:column;align-items:center;gap:6px}
  .icon-btn{
    width:54px;height:54px;border-radius:50%;border:none;background:transparent;
    color:var(--text);display:grid;place-items:center;cursor:pointer;transition:.15s transform ease
  }
  .icon-btn:hover{transform:translateY(-1px)}
  .icon-btn.active{background:color-mix(in oklab, var(--accent) 10%, transparent)}
  .label{font-size:13px;color:var(--muted)}
  .icon{width:24px;height:24px;fill:none;stroke:currentColor;stroke-width:2;stroke-linecap:round;stroke-linejoin:round}
</style>
</head>
<body>
  <header>
    <div class="brand">Pomodoro - Temporizador</div>
    <button id="themeToggle" class="theme-toggle"><span id="themeIcon">ðŸŒž</span><span>Modo</span></button>
  </header>

  <main>
    <div class="wrap">
      <div class="row">
        <button class="chip" data-min="20">20 min</button>
        <button class="chip" data-min="30">30 min</button>
        <!-- cambiado de 40 a 50 -->
        <button class="chip" data-min="50">50 min</button>
      </div>

      <div class="phase" id="phaseLabel">Estudio</div>

      <div class="timer">
        <svg viewBox="0 0 100 100">
          <circle cx="50" cy="50" r="46" fill="none" stroke="var(--ring)" stroke-width="6"/>
          <circle id="progress" cx="50" cy="50" r="46" fill="none" stroke="var(--accent)" stroke-width="6"
                  stroke-linecap="round" stroke-dasharray="289" stroke-dashoffset="289"/>
        </svg>
        <div class="time" id="time">00:00</div>
      </div>

      <!-- CONTROLES RESTAURADOS -->
      <div class="controls">
        <button id="playPause" class="btn" aria-label="Play/Pause">
          <svg viewBox="0 0 24 24" id="iconPlay">
            <polygon points="5 3 19 12 5 21 5 3"/>
          </svg>
        </button>
        <button id="reset" class="btn" aria-label="Reset">
          <svg viewBox="0 0 24 24">
            <path d="M4 4v6h6"/>
            <path d="M4 10a9 9 0 1 0 2.6-6.4"/>
          </svg>
        </button>
        <button id="skip" class="btn" aria-label="Skip">
          <svg viewBox="0 0 24 24">
            <polygon points="5 4 15 12 5 20 5 4"/>
            <line x1="19" y1="5" x2="19" y2="19"/>
          </svg>
        </button>
      </div>

      <p class="hint">Descanso de 5 min (10 si eliges 50 min).</p>
    </div>

    <!-- Sonidos centrados -->
    <section class="sounds">
      <h3>Sonido ambiente</h3>
      <div class="sound-grid">
        <div class="sound-tile">
          <button class="icon-btn" data-audio="white">
            <svg class="icon" viewBox="0 0 24 24">
              <path d="M11 5 6 9H3v6h3l5 4V5z"/>
              <path d="M15.5 8.5a5 5 0 0 1 0 7"/>
              <path d="M18 6a8 8 0 0 1 0 12"/>
            </svg>
          </button>
          <div class="label">Blanco</div>
        </div>

        <div class="sound-tile">
          <button class="icon-btn" data-audio="brown">
            <svg class="icon" viewBox="0 0 24 24">
              <path d="M11 5 6 9H3v6h3l5 4V5z"/>
              <path d="M16 9a4 4 0 0 1 0 6"/>
            </svg>
          </button>
          <div class="label">MarrÃ³n</div>
        </div>

        <div class="sound-tile">
          <button class="icon-btn" data-audio="rain">
            <svg class="icon" viewBox="0 0 24 24">
              <path d="M20 16a4 4 0 0 0-1-7 5 5 0 0 0-9-2 4 4 0 1 0-2 9h12z"/>
              <path d="M8 19v2M12 18v3M16 19v2"/>
            </svg>
          </button>
          <div class="label">Lluvia</div>
        </div>
      </div>

      <audio id="white" src="audio/white.mp3" loop></audio>
      <audio id="brown" src="audio/brown.mp3" loop></audio>
      <audio id="rain"  src="audio/rain.mp3"  loop></audio>
    </section>
  </main>

<script>
const themeIcon=document.getElementById("themeIcon");
function applyTheme(m){
  if(m==="dark"){document.body.setAttribute("data-theme","dark");themeIcon.textContent="ðŸŒ™";}
  else if(m==="light"){document.body.setAttribute("data-theme","light");themeIcon.textContent="ðŸŒž";}
  else{const d=matchMedia("(prefers-color-scheme: dark)").matches;document.body.setAttribute("data-theme",d?"dark":"light");themeIcon.textContent=d?"ðŸŒ™":"ðŸŒž";}
}
const savedTheme=localStorage.getItem("theme")||"auto";applyTheme(savedTheme);
document.getElementById("themeToggle").onclick=()=>{const c=document.body.getAttribute("data-theme");const n=c==="dark"?"light":"dark";localStorage.setItem("theme",n);applyTheme(n);};

// timer
const timeEl=document.getElementById("time"),phaseLabel=document.getElementById("phaseLabel"),progressCircle=document.getElementById("progress");
const circumference=2*Math.PI*46;progressCircle.style.strokeDasharray=String(circumference);
const presetButtons=[...document.querySelectorAll(".chip")];
const playPauseBtn=document.getElementById("playPause"),resetBtn=document.getElementById("reset"),skipBtn=document.getElementById("skip");
let timer=null,isRunning=false,isStudy=true,initialStudyMinutes=20,breakMinutes=5,totalSeconds=0,remaining=0;

function fmt(s){
  const m = String(Math.floor(s/60)).padStart(2,"0");
  const ss = String(s%60).padStart(2,"0");
  return `${m}:${ss}`;
}
function setProgress(){const ratio=remaining/totalSeconds;progressCircle.style.strokeDashoffset=String(circumference*(1-ratio));}
function paint(){timeEl.textContent=fmt(remaining);setProgress();}
function setPhase(study,min){isStudy=study;phaseLabel.textContent=study?"Estudio":"Descanso";totalSeconds=min*60;remaining=totalSeconds;paint();}
function choosePreset(m){
  initialStudyMinutes=m;
  // ahora 50 min activa descanso de 10
  breakMinutes=(m===50)?10:5;
  presetButtons.forEach(b=>b.classList.toggle("active",Number(b.dataset.min)===m));
  setPhase(true,initialStudyMinutes);
  stop();
}
function tick(){
  if(remaining>0){remaining--;paint();}
  if(remaining===0){
    if(isStudy){setPhase(false,breakMinutes);start();}
    else{setPhase(true,initialStudyMinutes);start();}
  }
}
function start(){clearInterval(timer);isRunning=true;updatePlayIcon(true);timer=setInterval(tick,1000);}
function stop(){clearInterval(timer);isRunning=false;updatePlayIcon(false);}
function updatePlayIcon(running){
  const icon=document.getElementById("iconPlay");
  icon.innerHTML=running
    ? '<rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/>'
    : '<polygon points="5 3 19 12 5 21 5 3"/>';
}
presetButtons.forEach(b=>b.onclick=()=>choosePreset(Number(b.dataset.min)));
playPauseBtn.onclick=()=>{if(!totalSeconds)choosePreset(initialStudyMinutes);isRunning?stop():start();};
resetBtn.onclick=()=>{remaining=totalSeconds;paint();};
skipBtn.onclick=()=>{if(isStudy){setPhase(false,breakMinutes);}else{setPhase(true,initialStudyMinutes);}if(isRunning)start();else paint();};
choosePreset(20);

// sonidos
const audios={white:document.getElementById("white"),brown:document.getElementById("brown"),rain:document.getElementById("rain")};
document.querySelectorAll(".icon-btn").forEach(btn=>{
  btn.onclick=async()=>{const id=btn.dataset.audio,a=audios[id];
    if(a.paused){try{await a.play();btn.classList.add("active");}catch{alert("InteractÃºa con la pÃ¡gina para activar sonido.");}}
    else{a.pause();btn.classList.remove("active");}
  };
});
</script>
</body>
</html>
